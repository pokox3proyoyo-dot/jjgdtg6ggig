<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Secure Hax Chat üîê</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
/* ==================================== */
/* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –∏ –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã */
/* ==================================== */
:root {
  --bg-color: linear-gradient(135deg, #2c003e, #5a006a, #ff5aab);
  --glass-bg: rgba(255, 255, 255, 0.1);
  --text-color: #f5f5f5;
  --header-color: #ffd6f7;
  --accent-color: #ff5aab;
  --button-gradient: linear-gradient(90deg, #ff5aab, #8a2be2);
  --success-color: #4CAF50;
}

body {
  font-family: 'Inter', sans-serif;
  background: var(--bg-color);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  color: var(--text-color);
  margin:0; padding:0;
  transition: background 0.3s ease;
  position: relative;
}

h1 { margin-top: 24px; font-size: 2rem; color: var(--header-color); text-shadow: 0 2px 8px rgba(0,0,0,0.5);}
.container { width: 90%; max-width: 800px; margin: 16px auto; padding-bottom: 50px; z-index: 100;}
.card { background: var(--glass-bg); border-radius: 16px; padding: 20px; margin-bottom: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.4); backdrop-filter: blur(4px); transition: transform 0.2s, box-shadow 0.2s;}
.card:hover { transform: translateY(-2px); box-shadow: 0 12px 24px rgba(0,0,0,0.6);}
textarea, input { width: 100%; box-sizing: border-box; margin: 6px 0; padding: 10px; border-radius: 10px; border: none; background: rgba(255,255,255,0.2); color: #fff; font-family: 'Roboto Mono', monospace; font-size: 0.95rem;}
button { background: var(--button-gradient); color: #fff; border: none; border-radius: 12px; padding: 12px 18px; margin-top: 8px; cursor: pointer; font-weight: 600; transition: transform 0.2s, box-shadow 0.3s, filter 0.2s; white-space: nowrap;}
button:hover { background: linear-gradient(90deg, #ff75c4, #a64ddb); transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.5); filter: brightness(1.1);}
button:active { transform: translateY(0); box-shadow: 0 4px 12px rgba(0,0,0,0.4);}
pre { background: var(--glass-bg); padding: 10px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; color: #fff; font-family: 'Roboto Mono', monospace;}
.row { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
.flex-col { display:flex; flex-direction:column;}
/* –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ—É—Ç–µ—Ä –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è Sans */
footer {
  width:100%;
  text-align:center;
  margin:24px 0;
  padding-bottom: 20px;
  position: relative;
  z-index: 100;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.footer-links {
    display: flex;
    justify-content: center;
    align-items: flex-end; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ –Ω–∏–∑—É */
    gap: 15px;
    position: relative; /* –î–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Sans */
    width: auto;
}
a { color: var(--accent-color); text-decoration: none; transition: color 0.2s;}
a:hover { color: #fff;}

/* ==================================== */
/* –°–ê–ù–° / –ò–ù–¢–ï–†–ê–ö–¢–ò–í */
/* ==================================== */
#sans-image {
  /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ, –Ω–µ–∑–∞–º–µ—Ç–Ω–æ–µ –º–µ—Å—Ç–æ: –≤ —Ñ—É—Ç–µ—Ä–µ, —Ä—è–¥–æ–º —Å –¢–µ–ª–µ–≥—Ä–∞–º–æ–º */
  width: 40px;
  height: 40px;
  cursor: pointer;
  border-radius: 50%;
  transition: transform 0.2s ease-out;
  box-shadow: 0 0 5px rgba(255, 255, 255, 0.5); /* –î–æ–±–∞–≤–∏–º –ª–µ–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ */
  background-color: rgba(255, 255, 255, 0.1); /* –õ–µ–≥–∫–∏–π —Ñ–æ–Ω */
  margin-bottom: -15px; /* –ü–æ–¥–Ω–∏–º–µ–º –µ–≥–æ –∫ Telegram –∏–∫–æ–Ω–∫–µ */
}

#sans-image:hover {
  transform: scale(1.1) rotate(5deg);
  filter: none; /* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ - —è—Ä–∫–∏–π Sans! */
}

#socks-message {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  padding: 20px 40px;
  background: rgba(0, 0, 0, 0.9);
  color: #fff000; /* –ñ–µ–ª—Ç—ã–π —Ü–≤–µ—Ç –¥–ª—è —Ç–µ–∫—Å—Ç–∞ */
  font-size: 2.5rem;
  font-family: 'Roboto Mono', monospace;
  border: 5px solid #ff5aab;
  box-shadow: 0 0 30px #ff5aab;
  border-radius: 10px;
  z-index: 3000;
  opacity: 0;
  transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
  pointer-events: none;
  text-align: center;
}
#socks-message.active {
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ (–ò–∑–º–µ–Ω–µ–Ω—ã –¥–ª—è –≤—ã–ª–µ—Ç–∞ —Å –±–æ–∫–æ–≤) */
#confetti-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 2500;
  overflow: hidden;
}
.confetti {
  position: absolute;
  width: 10px;
  height: 10px;
  opacity: 0;
  animation-duration: 3s;
  animation-fill-mode: forwards;
  animation-timing-function: cubic-bezier(.17,.67,.83,.67);
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –≤—ã–ª–µ—Ç–∞ —Å –±–æ–∫–æ–≤ */
@keyframes fall-left {
  0% { left: 0; top: 50%; transform: translate(-100%, -50%) rotate(0deg); opacity: 1; }
  100% { left: 50%; top: 100vh; transform: translate(-50%, 0) rotate(720deg); opacity: 0; }
}
@keyframes fall-right {
  0% { right: 0; top: 50%; transform: translate(100%, -50%) rotate(0deg); opacity: 1; }
  100% { right: 50%; top: 100vh; transform: translate(50%, 0) rotate(-720deg); opacity: 0; }
}

/* ==================================== */
/* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
/* ==================================== */

#menu-btn {
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 2000;
  width: auto;
  min-width: 90px;
  height: 50px;
  font-size: 1.1rem;
  padding: 0 15px;
  border-radius: 25px;
  background: var(--glass-bg);
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  color: var(--header-color);
  display: flex;
  align-items: center;
  justify-content: center;
}
#nav-menu {
  position: fixed;
  top: 70px;
  left: 15px;
  z-index: 1999;
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 15px;
  background: var(--glass-bg);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.5);
  transform: translateX(-150%);
  opacity: 0;
  transition: transform 0.3s ease-out, opacity 0.3s ease-out;
}
#nav-menu.active {
  transform: translateX(0);
  opacity: 1;
}
#nav-menu button {
  width: 150px;
  padding: 10px 15px;
  background: rgba(255, 255, 255, 0.1);
  box-shadow: none;
  border-radius: 10px;
}
#nav-menu button.active {
  background: var(--button-gradient);
}
#nav-menu button:hover {
  transform: none;
  box-shadow: 0 0 10px var(--accent-color);
}
.page {
  display: none;
  width: 100%;
  animation: fadeIn 0.5s ease-out;
}
.page.active {
  display: block;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
#home-page {
    background:
        radial-gradient(circle 400px at 50% 10%, rgba(255, 90, 171, 0.1), transparent),
        radial-gradient(circle 300px at 80% 90%, rgba(138, 43, 226, 0.1), transparent),
        repeating-linear-gradient(0deg, #2c003e, #2c003e 1px, transparent 1px, transparent 100px),
        repeating-linear-gradient(90deg, #2c003e, #2c003e 1px, transparent 1px, transparent 100px);
    background-color: #330044;
    padding-top: 20px;
    text-align: center;
}
#home-page h2 { color: var(--accent-color); font-size: 1.5rem; border-bottom: 2px solid var(--accent-color); padding-bottom: 5px; display: inline-block;}
#home-page p { line-height: 1.6; text-align: left; margin-bottom: 20px;}
.skeleton-joke {
    background: var(--glass-bg);
    padding: 15px;
    border-radius: 10px;
    margin: 20px 0;
    border-left: 5px solid var(--accent-color);
    font-style: italic;
    color: var(--header-color);
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
    text-align: left;
}
.skeleton-joke strong { color: lime; }
.img-grid { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 30px;}
.img-hacker {
  width: 150px;
  height: 150px;
  background: #333;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.6);
  transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Roboto Mono', monospace;
  font-size: 1.2rem;
  overflow: hidden;
  position: relative;
}
.img-hacker i {
    font-size: 3rem;
    color: var(--success-color);
    text-shadow: 0 0 10px var(--success-color);
    z-index: 2;
}
.img-hacker span {
    position: absolute;
    bottom: 5px;
    font-size: 0.9rem;
    color: #fff;
    z-index: 2;
}
.img-hacker:before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.4);
  z-index: 1;
}
.img-hacker:hover {
  transform: scale(1.05);
  box-shadow: 0 0 30px var(--accent-color);
}
/* *** –ò–ó–ú–ï–ù–ï–ù–ò–ï –°–¢–ò–õ–ï–ô –î–õ–Ø –ú–ï–ú-–†–ï–ñ–ò–ú–ê *** */
/* –£–±—Ä–∞—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫—Ä–æ–º–µ —Ñ–æ–Ω–∞ –∏ —Å–∞–º–æ–≥–æ MEME_PAGE_CONTENT */
.meme-mode > .container,
.meme-mode #menu-btn,
.meme-mode #nav-menu,
.meme-mode footer {
    display: none;
}
.meme-mode {
    background: black !important;
    transition: background 0.1s;
}
/* *** –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–ô –°–¢–ò–õ–ï–ô *** */

#meme-page-content {
    /* –°—Ç–∏–ª—å –¥–ª—è —Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ body */
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: green;
    font-size: 2rem;
    font-family: 'Roboto Mono', monospace;
    z-index: 1000;
    text-shadow: 0 0 10px green, 0 0 20px green;
    overflow: hidden;
    pointer-events: none;
    padding: 20px;
}
.meme-bg-text {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    white-space: pre-wrap;
    word-wrap: break-word;
    color: red;
    opacity: 0.1;
    font-size: 10vmin;
    line-height: 1.2;
    pointer-events: none;
    font-family: 'Roboto Mono', monospace;
    z-index: 999;
    user-select: none;
    padding: 10px;
}
#toast-container { position: fixed; top:20px; right:20px; z-index:9999;}
.toast { background: rgba(255,255,255,0.2); color: #fff; padding: 10px 16px; margin-top: 8px; border-radius: 10px; box-shadow:0 4px 12px rgba(0,0,0,0.5); backdrop-filter: blur(3px); font-weight:500; transition: opacity 0.3s ease, transform 0.3s ease; opacity:0; transform: translateY(-20px);}

</style>
</head>
<body>

<button id="menu-btn" onclick="toggleMenu()">‚â° Menu</button>
<nav id="nav-menu">
  <button data-page="home" class="active">–ì–ª–∞–≤–Ω–∞—è</button>
  <button data-page="chat">–ß–∞—Ç</button>
  <button data-page="meme">–ú–µ–º</button>
</nav>

<div class="container">
  <div id="home-page" class="page active">
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Secure Hax Chat üîê</h1>

    <div id="socks-message">–Ø –Ω–µ —É–±—Ä–∞–ª –Ω–æ—Å–∫–∏!</div>
    <div id="confetti-container"></div>

    <div class="skeleton-joke">
        "–ü–æ—á–µ–º—É –°–∫–µ–ª–µ—Ç –Ω–µ –ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º —á–∞—Ç–æ–º? –ü–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–µ–≥–æ –Ω–µ—Ç –∫–∏—à–æ–∫, —á—Ç–æ–±—ã –¥–µ–ª–∏—Ç—å—Å—è –∏–º–∏! <strong>Secure Hax</strong> ‚Äì —á–∞—Ç, –∫–æ—Ç–æ—Ä–æ–º—É –º–æ–∂–Ω–æ –¥–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–∏ –∫–æ—Å—Ç–∏."
    </div>

    <div class="card">
      <h2>üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –í–∞—à–∏—Ö –î–∞–Ω–Ω—ã—Ö</h2>
      <p>
        –í –º–∏—Ä–µ, –≥–¥–µ —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥–≤–µ—Ä–≥–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —É–≥—Ä–æ–∑–µ, –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ —Ä–æ—Å–∫–æ—à—å—é, –∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å—é. –≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç <strong>–≤—ã—Å–æ–∫–æ–Ω–∞–¥–µ–∂–Ω—É—é –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—é (TweetNaCl)</strong> –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ç–æ–≥–æ, —á—Ç–æ –≤–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤–∞–º –∏ –≤–∞—à–µ–º—É —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫—É.
      </p>

      <h3>–ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?</h3>
      <p>
        –í–∞—à–∏ –∫–ª—é—á–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ **–ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (localStorage)**. –ú—ã –Ω–µ —Ö—Ä–∞–Ω–∏–º –≤–∞—à–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∞ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∏–∫—Ç–æ, –≤–∫–ª—é—á–∞—è –Ω–∞—Å, –Ω–µ –∏–º–µ–µ—Ç –∫ –Ω–∏–º –¥–æ—Å—Ç—É–ø–∞.
      </p>

      <h3>–ö–∞–∫ –Ω–∞—á–∞—Ç—å?</h3>
      <p>
        –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ß–∞—Ç". –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–∞—Ä—É –∫–ª—é—á–µ–π. –û–±–º–µ–Ω—è–π—Ç–µ—Å—å **–ø—É–±–ª–∏—á–Ω—ã–º** –∫–ª—é—á–æ–º —Å –≤–∞—à–∏–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ–±–º–µ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.
      </p>

      <div class="img-grid">
        <div class="img-hacker">
          <i class="fas fa-key"></i>
          <span>–ö–ª—é—á–∏</span>
        </div>
        <div class="img-hacker">
          <i class="fas fa-lock-open"></i>
          <span>–û–±–º–µ–Ω</span>
        </div>
        <div class="img-hacker">
          <i class="fas fa-shield-alt"></i>
          <span>–ó–∞—â–∏—Ç–∞</span>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>üóÇÔ∏è –ù–∞—à–∞ –§–∏–ª–æ—Å–æ—Ñ–∏—è –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h2>
      <p>
        –ú—ã –≤–µ—Ä–∏–º, —á—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–æ—Å—Ç–æ–π. –ù–∞—à –∫–æ–¥ ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–π, –∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ TweetNaCl, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–≤–Ω–æ –ø—Ä–∏–∑–Ω–∞–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º). –ú—ã –Ω–µ —É—Å–ª–æ–∂–Ω—è–µ–º –ø—Ä–æ—Ü–µ—Å—Å: —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –∫–ª—é—á–∏, –æ–±–º–µ–Ω—è–ª—Å—è –ø—É–±–ª–∏—á–Ω—ã–º ‚Äî –∏ —Ç—ã —É–∂–µ –≤ –∫—Ä–∏–ø—Ç–æ-–±—É–Ω–∫–µ—Ä–µ. **–ù–∏–∫–∞–∫–∏—Ö –±—ç–∫–¥–æ—Ä–æ–≤, —Ç–æ–ª—å–∫–æ —Å–∫–µ–ª–µ—Ç—ã –∏ –Ω–∞–¥–µ–∂–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞.**
      </p>
    </div>

    <div class="skeleton-joke">
        "–°–µ–∫—Ä–µ—Ç —Ö–æ—Ä–æ—à–µ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è? –ö–æ—Å—Ç–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫—Ä–µ–ø–∫–∏–º–∏, –∞ –∞–ª–≥–æ—Ä–∏—Ç–º - –Ω–µ–ø—Ä–æ–±–∏–≤–∞–µ–º—ã–º! <strong>(–≠—Ç–æ –Ω–µ —Å–∞—Ä–∫–∞–∑–º, —ç—Ç–æ TweetNaCl.)</strong>"
    </div>

    <div class="card">
        <h2>‚ú® –ß—Ç–æ –¥–∞–ª—å—à–µ?</h2>
        <p>
            –ú—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ —É–ª—É—á—à–µ–Ω–∏–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –í –±—É–¥—É—â–µ–º –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–º–µ–Ω–∞ —Ñ–∞–π–ª–∞–º–∏ —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ SOCKS. –ù–æ –ø–æ–∫–∞ —á—Ç–æ, –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —Å–∞–º—ã–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∏ –Ω–µ–º–Ω–æ–≥–æ —Å—Ç—Ä–∞–Ω–Ω—ã–º —á–∞—Ç–æ–º –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ!
        </p>
    </div>

    <div class="skeleton-joke">
        "–•–∞–∫–µ—Ä-—Å–∫–µ–ª–µ—Ç –∑–∞—à–µ–ª –≤ —á–∞—Ç. –ï–º—É –≥–æ–≤–æ—Ä—è—Ç: '–ü—Ä–∏–≤–µ—Ç!'. –ê –æ–Ω –≤ –æ—Ç–≤–µ—Ç: '–ü—Ä–æ—Å—Ç–æ **–∫–æ—Å—Ç–∏**!'"
    </div>

  </div>

<section id="chat-page" class="page">
    <h1>Secure Hax Chat</h1>
    <p>–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ end-to-end —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é TweetNaCl. –í–∞—à–∏ –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ.</p>

    <div class="card" id="card-my-keys">
        <h2>1Ô∏è‚É£ –¢–≤–æ–π –∫–ª—é—á</h2>
        <div class="row">
            <button id="gen">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—É –∫–ª—é—á–µ–π</button>
            <button id="resetBtn" class="small">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∫–ª—é—á–∏</button>
        </div>

        <div id="pubArea" style="display: none; flex-direction: column;">
            <label>–¢–≤–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (Base64)</label>
            <textarea id="myPub" rows="3" readonly placeholder="–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏"></textarea>
            <div class="row" style="margin-top: 5px;">
                <button id="copyPub" class="small">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á</button>
            </div>
            <div class="helper">
                –û—Ç–ø–µ—á–∞—Ç–æ–∫: <code id="myFp" style="color:#fff; background:transparent; font-family:monospace;">–ù–µ—Ç –∫–ª—é—á–∞</code>
            </div>
        </div>

        </div>

    <div class="card" id="card-peer">
        <h2>2Ô∏è‚É£ –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞</h2>
        <label>–í—Å—Ç–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ (Base64)</label>
        <textarea id="peerPub" rows="3" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á"></textarea>
        <div class="row">
            <button id="importPeer" class="small" disabled>–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        <div class="helper">
            –û—Ç–ø–µ—á–∞—Ç–æ–∫ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞: <code id="peerFp" style="color:#fff; background:transparent; font-family:monospace;">–ù–µ—Ç –∫–ª—é—á–∞</code>
        </div>
    </div>

    <div class="card" id="card-encrypt">
        <h2>3Ô∏è‚É£ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h2>
        <label>–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</label>
        <textarea id="plain" rows="4" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"></textarea>
        <div class="row">
            <button id="encryptBtn" class="small" disabled>–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
            <button id="copyCipher" class="small" disabled>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —à–∏—Ñ—Ä—Ç–µ–∫—Å—Ç</button>
        </div>
        <label style="margin-top:10px;">–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞</label>
        <textarea id="cipherout" rows="4" readonly></textarea>
    </div>

    <div class="card" id="card-decrypt">
        <h2>4Ô∏è‚É£ –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h2>
        <label>–í—Å—Ç–∞–≤—å—Ç–µ —à–∏—Ñ—Ä—Ç–µ–∫—Å—Ç</label>
        <textarea id="cipherin" rows="4" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É"></textarea>
        <div class="row">
            <button id="decryptBtn" class="small" disabled>–î–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
        </div>
        <label style="margin-top:10px;">–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç</label>
        <textarea id="plainout" rows="4" readonly></textarea>
    </div>
</section>

  <div id="meme-page" class="page"></div>
</div>

<div id="toast-container"></div>
<footer>
    <div class="footer-links">
        <img id="sans-image"
             src="https://avatanplus.com/files/resources/mid/57b39ece5502b15695a4560c.png"
             onclick="activateSansMeme(event)">
        <a href="https://t.me/securehaxchat" target="_blank" title="Telegram">
            <i class="fab fa-telegram fa-2x"></i>
        </a>
    </div>
    <small style="margin-top: 10px;">
        ¬© 2025 Secure Hax Inc. | <a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
    </small>
</footer>

<script src="nacl.min.js"></script>
<script src="nacl-util.min.js"></script>
<script>
// ====================================
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –ú–µ–º—ã)
// ====================================

const state = {
  activePage: 'home',
  memeClicks: 0,
  isMemeActive: false,
  isSansActive: false,
};

const pages = document.querySelectorAll('.page');
const navButtons = document.querySelectorAll('#nav-menu button');
const menuBtn = document.getElementById('menu-btn');
const navMenu = document.getElementById('nav-menu');
const toastContainer = document.getElementById('toast-container');

function toggleMenu() {
  navMenu.classList.toggle('active');
  menuBtn.textContent = navMenu.classList.contains('active') ? '‚úñ Close' : '‚â° Menu';
}

function showPage(pageId) {
  state.activePage = pageId;
  pages.forEach(page => {
    if (page.id !== pageId + '-page') {
        page.classList.remove('active');
    }
  });

  navButtons.forEach(btn => {
    btn.classList.remove('active');
    if (btn.getAttribute('data-page') === pageId) {
      btn.classList.add('active');
    }
  });

  const currentPage = document.getElementById(pageId + '-page');
  if (currentPage) {
    currentPage.classList.add('active');
  }

  if (pageId === 'meme') {
    enterMemeMode();
  } else {
    exitMemeMode();
  }
}

navButtons.forEach(button => {
  button.addEventListener('click', (e) => {
    const pageId = e.target.getAttribute('data-page');
    showPage(pageId);
    toggleMenu();
  });
});

// ====================================
// –°–ê–ù–° / –ò–ù–¢–ï–†–ê–ö–¢–ò–í (–û–î–ò–ù –ö–õ–ò–ö)
// ====================================

const SANS_IMAGE = document.getElementById('sans-image');
const SANS_MESSAGE = document.getElementById('socks-message');
const CONFETTI_CONTAINER = document.getElementById('confetti-container');

const CONFETTI_COLORS = ['#ff0000', '#ffff00', '#0000ff', '#ff5aab'];

function createConfetti(count) {
    for (let i = 0; i < count; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.backgroundColor = CONFETTI_COLORS[Math.floor(Math.random() * CONFETTI_COLORS.length)];
        confetti.style.left = (Math.random() < 0.5 ? 0 : 100) + 'vw';
        confetti.style.top = Math.random() * 100 + 'vh';
        confetti.style.width = Math.random() * 10 + 5 + 'px';
        confetti.style.height = confetti.style.width;

        confetti.style.animationName = (i % 2 === 0) ? 'fall-left' : 'fall-right';
        confetti.style.animationDelay = Math.random() * 0.5 + 's';
        confetti.style.animationDuration = Math.random() * 2 + 3 + 's';

        CONFETTI_CONTAINER.appendChild(confetti);

        confetti.addEventListener('animationend', () => {
            confetti.remove();
        });
    }
}

// –ü–ï–†–ï–û–ü–†–ï–î–ï–õ–Ø–ï–¢–°–Ø –ù–ò–ñ–ï
// function activateSansMeme(event) { ... }

// ====================================
// –ú–ï–ú-–†–ï–ñ–ò–ú (–§–û–ù)
// ====================================

const MEME_TEXT_CONTENT = "HAX LO L SOCKS HAXXOR MEME HAXOR LOL SHCURE HAX LOL MEME HAXOR SKUL SOCKS HAX LOL SCURE HAX MEME LOL";
let memeInterval;
let memeBgText;
let memePageContent;

function createMemeBg() {
    memeBgText = document.createElement('div');
    memeBgText.className = 'meme-bg-text';
    document.body.appendChild(memeBgText);
}

function updateMemeBg() {
    if (!memeBgText) return;

    let content = "";
    for (let i = 0; i < 200; i++) {
        const text = MEME_TEXT_CONTENT.split(' ')[Math.floor(Math.random() * MEME_TEXT_CONTENT.split(' ').length)];
        content += text + " ".repeat(Math.floor(Math.random() * 5) + 1);
    }
    memeBgText.textContent = content;
}

function enterMemeMode() {
    if (state.isMemeActive) return;
    state.isMemeActive = true;
    document.body.classList.add('meme-mode');
    if (!memeBgText) createMemeBg();
    updateMemeBg();
    memeInterval = setInterval(updateMemeBg, 100);

    memePageContent = document.createElement('div');
    memePageContent.id = 'meme-page-content';
    memePageContent.innerHTML = `
        <h1>LOADING HACKER.EXE...</h1>
        <p>1337 HAX ACTIVATED. SECURITY IS FOR NOOBS.</p>
    `;
    document.body.appendChild(memePageContent);
}

function exitMemeMode() {
    if (!state.isMemeActive) return;
    state.isMemeActive = false;
    document.body.classList.remove('meme-mode');
    clearInterval(memeInterval);

    if (memeBgText) {
        memeBgText.remove();
        memeBgText = null;
    }
    if (memePageContent) {
        memePageContent.remove();
        memePageContent = null;
    }
}


// =================================================================
// –°–ï–ö–¶–ò–Ø –ö–†–ò–ü–¢–û–ì–†–ê–§–ò–ò: –ò–ó –°–¢–ê–†–û–ô –í–ï–†–°–ò–ò
// =================================================================

(function(){
¬† // util aliases
¬† const util = nacl.util;
¬† const encodeB64 = util.encodeBase64;
¬† const decodeB64 = util.decodeBase64;
¬† const encodeUTF8 = util.encodeUTF8;
¬† const decodeUTF8 = util.decodeUTF8;

¬† // DOM Elements (–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ ID –∏–∑ –≤–∞—à–µ–≥–æ —Ç–µ–∫—É—â–µ–≥–æ HTML)
¬† const genBtn = document.getElementById('gen');
¬† const myPubEl = document.getElementById('myPub');
¬† const myFpEl = document.getElementById('myFp');
¬† const copyPubBtn = document.getElementById('copyPub');
¬† const resetBtn = document.getElementById('resetBtn'); // –ò—Å–ø–æ–ª—å–∑—É–µ–º resetBtn –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
¬† const pubArea = document.getElementById('pubArea'); // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–ª—é—á–∞

¬† const peerPubEl = document.getElementById('peerPub');
¬† const importPeerBtn = document.getElementById('importPeer');
¬† const peerFpEl = document.getElementById('peerFp');

¬† const plainEl = document.getElementById('plain');
¬† const encryptBtn = document.getElementById('encryptBtn');
¬† const cipherOutEl = document.getElementById('cipherout');
¬† const copyCipherBtn = document.getElementById('copyCipher');

¬† const cipherInEl = document.getElementById('cipherin');
¬† const decryptBtn = document.getElementById('decryptBtn');
¬† const plainOutEl = document.getElementById('plainout');

¬† // –¢–û–°–¢–´ (–°–ö–û–ü–ò–†–û–í–ê–ù–û –ò–ó –°–¢–ê–†–û–ô –í–ï–†–°–ò–ò)
¬† // const toastContainer = document.getElementById('toast-container'); // –û–±—ä—è–≤–ª–µ–Ω –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
¬† function showToast(msg, ms=2600){
¬† ¬† const t = document.createElement('div');
¬† ¬† t.className = 'toast';
¬† ¬† t.textContent = msg;
¬† ¬† toastContainer.appendChild(t);
¬† ¬† // animate in
¬† ¬† requestAnimationFrame(()=>{ t.style.opacity='1'; t.style.transform='translateY(0)'; });
¬† ¬† setTimeout(()=>{ t.style.opacity='0'; t.style.transform='translateY(-10px)'; t.addEventListener('transitionend', ()=> t.remove()); }, ms);
¬† }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–µ–º–∞, —á—Ç–æ–±—ã –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ showToast
  SANS_IMAGE.addEventListener('click', activateSansMeme);
  function activateSansMeme(event) {
    if (state.activePage !== 'home') return;

    if (state.isSansActive) {
        showToast('...—Ç—ã —É–∂–µ —Å–¥–µ–ª–∞–ª —Å–≤–æ–π –≤—ã–±–æ—Ä.', 1000);
        return;
    }

    state.isSansActive = true;
    createConfetti(100);
    SANS_MESSAGE.classList.add('active');

    setTimeout(() => {
        SANS_MESSAGE.classList.remove('active');
        showToast('...–∏ —ç—Ç–æ –º–æ—è –ø–æ—Å–ª–µ–¥–Ω—è—è —à—É—Ç–∫–∞.', 2500);
    }, 2000);
  }


¬† // state
¬† let myKeyPair = null; // { publicKey: Uint8Array, secretKey: Uint8Array }
¬† let peerPubUint8 = null;

¬† const MAX_LEN = 5000;
¬† const PUB_LEN = 32;
¬† const NONCE_LEN = 24;

¬† // helpers
¬† async function sha256hex(u8){
¬† ¬† if (typeof crypto === 'undefined' || !crypto.subtle) return 'Crypto API not available';
¬† ¬† const hash = await crypto.subtle.digest('SHA-256', u8);
¬† ¬† return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');
¬† }

¬† function copyToClipboard(txt){
¬† ¬† if(!txt) { showToast('–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è'); return; }
    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(txt).then(()=> showToast('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞')).catch(()=>{
            try {
                const tempEl = document.createElement('textarea');
                tempEl.value = txt;
                document.body.appendChild(tempEl);
                tempEl.select();
                document.execCommand('copy');
                document.body.removeChild(tempEl);
                showToast('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
            } catch(e) {
                showToast('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è');
            }
        });
    } else {
        try {
            const tempEl = document.createElement('textarea');
            tempEl.value = txt;
            document.body.appendChild(tempEl);
            tempEl.select();
            document.execCommand('copy');
            document.body.removeChild(tempEl);
            showToast('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
        } catch(e) {
            showToast('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è');
        }
    }
¬† }

¬† function enableButtonsForKeys(){
¬† ¬† const hasKeyPair = !!myKeyPair;
¬† ¬† const hasPeerKey = !!peerPubUint8;
¬† ¬† const plainNotEmpty = plainEl.value.trim().length > 0;

¬† ¬† // importPeerBtn –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ç–µ–∫—Å—Ç–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
¬† ¬† importPeerBtn.disabled = peerPubEl.value.trim().length === 0;

¬† ¬† // encryptBtn –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ–±–æ–∏—Ö –∫–ª—é—á–µ–π –ò —Ç–µ–∫—Å—Ç–∞
¬† ¬† encryptBtn.disabled = !(hasKeyPair && hasPeerKey && plainNotEmpty);

¬† ¬† // decryptBtn –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–∞—à–µ–≥–æ –∫–ª—é—á–∞ –∏ –∫–ª—é—á–∞ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ (–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è)
¬† ¬† decryptBtn.disabled = !(hasKeyPair && hasPeerKey);

¬† ¬† // copyCipherBtn (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ MutationObserver, –Ω–æ –ª—É—á—à–µ –æ–±–Ω–æ–≤–∏—Ç—å –∏ –∑–¥–µ—Å—å)
¬† ¬† copyCipherBtn.disabled = cipherOutEl.value.trim().length === 0;

¬† ¬† // –°–∫—Ä—ã—Ç–∏–µ/–ø–æ–∫–∞–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–ª—é—á–∞
¬† ¬† pubArea.style.display = hasKeyPair ? 'flex' : 'none';

¬† ¬† if (!hasKeyPair) {
      myFpEl.textContent = '–ù–µ—Ç –∫–ª—é—á–∞';
      myPubEl.value = '';
    }
    if (!hasPeerKey) {
      peerFpEl.textContent = '–ù–µ—Ç –∫–ª—é—á–∞';
    }
¬† }

¬† // storage helpers (—Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤–æ–µ–π –ø–∞—Ä—ã)
¬† function saveMyPairToStorage(){
¬† ¬† if(!myKeyPair) return;
¬† ¬† try{
¬† ¬† ¬† localStorage.setItem('sc_my_pair', JSON.stringify({
¬† ¬† ¬† ¬† pub: encodeB64(myKeyPair.publicKey),
¬† ¬† ¬† ¬† sec: encodeB64(myKeyPair.secretKey)
¬† ¬† ¬† }));
¬† ¬† ¬† showToast('–ü–∞—Ä–∞ –∫–ª—é—á–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ localStorage');
¬† ¬† ¬† enableButtonsForKeys();
¬† ¬† }catch(e){ showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + e.message); }
¬† }

¬† function loadMyPairFromStorage(){
¬† ¬† const raw = localStorage.getItem('sc_my_pair');
¬† ¬† if(!raw) return false;
¬† ¬† try{
¬† ¬† ¬† const parsed = JSON.parse(raw);
¬† ¬† ¬† myKeyPair = {
¬† ¬† ¬† ¬† publicKey: decodeB64(parsed.pub),
¬† ¬† ¬† ¬† secretKey: decodeB64(parsed.sec)
¬† ¬† ¬† };
¬† ¬† ¬† myPubEl.value = parsed.pub;
¬† ¬† ¬† pubArea.style.display = 'flex';
¬† ¬† ¬† sha256hex(myKeyPair.publicKey).then(fp=> myFpEl.textContent = fp.slice(0,32));
¬† ¬† ¬† showToast('–ü–∞—Ä–∞ –∫–ª—é—á–µ–π –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ localStorage');
¬† ¬† ¬† return true;
¬† ¬† }catch(e){ console.error(e); return false; }
¬† }

¬† function clearAllStorage(){
¬† ¬† localStorage.removeItem('sc_my_pair');
¬† ¬† localStorage.removeItem('sc_peer_pub');
¬† ¬† myKeyPair = null;
¬† ¬† peerPubUint8 = null;
¬† ¬† myPubEl.value = '';
¬† ¬† peerPubEl.value = '';
¬† ¬† cipherOutEl.value = '';
¬† ¬† cipherInEl.value = '';
¬† ¬† plainEl.value = '';
¬† ¬† plainOutEl.value = '';
¬† ¬† pubArea.style.display = 'none';
¬† ¬† showToast('–í—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∏ –ø–æ–ª—è –æ—á–∏—â–µ–Ω—ã');
¬† ¬† enableButtonsForKeys();
¬† }

¬† // core crypto
¬† function generateKeyPair(){
¬† ¬† const kp = nacl.box.keyPair();
¬† ¬† myKeyPair = { publicKey: kp.publicKey, secretKey: kp.secretKey };
¬† ¬† const pubB64 = encodeB64(kp.publicKey);

¬† ¬† // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
¬† ¬† myPubEl.value = pubB64;
¬† ¬† pubArea.style.display = 'flex';
¬† ¬† sha256hex(kp.publicKey).then(fp => myFpEl.textContent = fp.slice(0,32));

¬† ¬† // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏)
¬† ¬† saveMyPairToStorage();

¬† ¬† // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ (–∫–∞–∫ –≤—ã –ø—Ä–æ—Å–∏–ª–∏)
¬† ¬† copyToClipboard(pubB64);

¬† ¬† showToast('–ü–∞—Ä–∞ –∫–ª—é—á–µ–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');
¬† ¬† enableButtonsForKeys();
¬† }


¬† function importPeerFromField(){
  const s = peerPubEl.value.trim();
  if(!s){ showToast('–í—Å—Ç–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ –ø–æ–ª–µ'); return; }
  try{
    const u8 = decodeB64(s);
    if(u8.length !== PUB_LEN) throw new Error('–Ω–µ–≤–µ—Ä–Ω–∞—è –¥–ª–∏–Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞');
    peerPubUint8 = u8;
    sha256hex(peerPubUint8).then(fp => peerFpEl.textContent = fp.slice(0,32));
    // peerPubEl.value = ''; // ‚ùå —É–±–∏—Ä–∞–µ–º –æ—á–∏—Å—Ç–∫—É
    showToast('–ö–ª—é—á —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω');
    enableButtonsForKeys();
  }catch(e){
    showToast('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –∫–ª—é—á–∞: ' + (e.message||''));
  }
}



function encryptMessage() {
    const text = plainEl.value.trim();
    if (!text) {
        showToast('–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ');
        return;
    }
    if (!myKeyPair || !peerPubUint8) {
        showToast('–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–ª—é—á–∏ (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ)');
        return;
    }

    if (text.length > MAX_LEN) {
        showToast('–°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ');
        return;
    }

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π nonce
    const nonce = nacl.randomBytes(NONCE_LEN);

    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ç–µ–∫—Å—Ç –≤ Uint8Array
    const msgUint8 = nacl.util.decodeUTF8(text);

    // –®–∏—Ñ—Ä—É–µ–º —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–π
    const box = nacl.box(msgUint8, nonce, peerPubUint8, myKeyPair.secretKey);

    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É –≤–∏–¥–∞ nonce:cipher (Base64)
    cipherOutEl.value = nacl.util.encodeBase64(nonce) + ':' + nacl.util.encodeBase64(box);

    // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
    plainEl.value = '';

    showToast('–°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ');
    enableButtonsForKeys();
}


function decryptMessage(){
  const s = cipherInEl.value.trim();
  if(!s){ showToast('–í—Å—Ç–∞–≤—å—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É'); return; }
  if(!myKeyPair || !peerPubUint8){ showToast('–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–ª—é—á–∏'); return; }
  try{
    // —É–¥–∞–ª—è–µ–º –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø–µ—Ä–µ–Ω–æ—Å—ã –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏
    const cleanStr = s.replace(/\s+/g,'');
    const parts = cleanStr.split(':');
    if(parts.length !== 2) throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–æ–∂–∏–¥–∞–µ—Ç—Å—è nonce:ct)');

    const nonce = decodeB64(parts[0]);
    const ct = decodeB64(parts[1]);

    const msgU8 = nacl.box.open(ct, nonce, peerPubUint8, myKeyPair.secretKey);
    if(!msgU8) throw new Error('–î–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ)');

    const text = encodeUTF8(msgU8);
    plainOutEl.value = text;
    cipherInEl.value = '';
    showToast('–°–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ');
  }catch(e){
    showToast('–û—à–∏–±–∫–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∏: ' + (e.message||''));
  }
}


¬† // init listeners
¬† genBtn.addEventListener('click', ()=> {
¬† ¬† generateKeyPair();
¬† });

¬† resetBtn.addEventListener('click', ()=> {
    if(confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∏ –ø–æ–ª—è?')) clearAllStorage();
  });

¬† copyPubBtn.addEventListener('click', ()=> copyToClipboard(myPubEl.value));
¬† importPeerBtn.addEventListener('click', ()=> importPeerFromField());

¬† encryptBtn.addEventListener('click', ()=> encryptMessage());
¬† copyCipherBtn.addEventListener('click', ()=> copyToClipboard(cipherOutEl.value));
¬† decryptBtn.addEventListener('click', ()=> decryptMessage());

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É—à–∞—Ç–µ–ª–µ–π –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
  // –°–ª–µ–¥–∏–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ —Ç–µ–∫—Å—Ç–∞ –≤ –ø–æ–ª–µ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –∏ plaintext
function updateButtons() {
  enableButtonsForKeys();
}

peerPubEl.addEventListener('input', updateButtons);
plainEl.addEventListener('input', updateButtons);

// –¢–∞–∫–∂–µ –ª–æ–≤–∏–º –≤—Å—Ç–∞–≤–∫—É —Ç–µ–∫—Å—Ç–∞ (paste), —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∞—Å—å –∫–Ω–æ–ø–∫–∞ "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å"
peerPubEl.addEventListener('paste', () => {
  setTimeout(enableButtonsForKeys, 50);
});

// –ò –ø—Ä–∏ –∫–ª–∏–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî —á—Ç–æ–±—ã –µ—Å–ª–∏ –ø–æ–ª–µ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ, –∫–Ω–æ–ø–∫–∞ –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞
peerPubEl.addEventListener('focus', enableButtonsForKeys);

¬† // keyboard shortcuts (Enter)
¬† peerPubEl.addEventListener('keydown', e=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); importPeerFromField(); }});
¬† plainEl.addEventListener('keydown', e=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); encryptMessage(); }});
¬† cipherInEl.addEventListener('keydown', e=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); decryptMessage(); }});

¬† // try load saved pair and peer on startup
¬† loadMyPairFromStorage();
¬† // loadPeerFromStorage(); // –û—Ç–∫–ª—é—á–µ–Ω–æ, —Ç.–∫. –Ω–µ—Ç –∫–Ω–æ–ø–∫–∏ –≤ HTML

¬† // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
¬† document.addEventListener('DOMContentLoaded', () => {
    enableButtonsForKeys();
    showPage('home');
  });

¬† // small UX: disable copy buttons when empty (MutationObserver –∏–∑ —Å—Ç–∞—Ä–æ–π –ª–æ–≥–∏–∫–∏)
¬† const observer = new MutationObserver(enableButtonsForKeys);
¬† observer.observe(cipherOutEl, { childList:true, subtree:true, characterData:true });


})(); // eof
</script>
</body>
</html>
